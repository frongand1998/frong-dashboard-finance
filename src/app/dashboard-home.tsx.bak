import { ArrowDownRight, ArrowUpRight, PiggyBank, Wallet2 } from "lucide-react";
import { CardSection } from "@/components/ui/card";
import { PageShell } from "@/components/layout/PageShell";
import { StatCard } from "@/components/dashboard/StatCard";
import { GoalProgress } from "@/components/dashboard/GoalProgress";
import { TransactionsTable } from "@/components/dashboard/TransactionsTable";
import { IncomeExpenseChart } from "@/components/charts/IncomeExpenseChart";
import { formatCurrency } from "@/lib/utils";
import type { Transaction, Goal } from "@/types";

const summary = {
  income: 18250,
  expenses: 12480,
  net: 5770,
};

const chartData = [
  { label: "Jan", income: 12000, expense: 7800 },
  { label: "Feb", income: 13250, expense: 8200 },
  { label: "Mar", income: 14500, expense: 9100 },
  { label: "Apr", income: 15600, expense: 9800 },
  { label: "May", income: 16900, expense: 10400 },
  { label: "Jun", income: 18250, expense: 12480 },
];

const goals: Goal[] = [
  {
    id: "goal-1",
    name: "Emergency fund",
    targetAmount: 10000,
    currentAmount: 7200,
    dueDate: "2025-12-31",
    status: "on_track",
  },
  {
    id: "goal-2",
    name: "Vacation",
    targetAmount: 4000,
    currentAmount: 1800,
    dueDate: "2025-08-15",
    status: "at_risk",
  },
  {
    id: "goal-3",
    name: "Student loan payoff",
    targetAmount: 18000,
    currentAmount: 6400,
    dueDate: "2026-03-01",
    status: "off_track",
  },
];

const recentTransactions: Transaction[] = [
  {
    id: "tx-1",
    type: "income",
    category: "Salary",
    amount: 7200,
    date: "2025-06-28",
    note: "June payroll",
  },
  {
    id: "tx-2",
    type: "expense",
    category: "Rent",
    amount: 2800,
    date: "2025-06-27",
    note: "July rent",
  },
  {
    id: "tx-3",
    type: "expense",
    category: "Groceries",
    amount: 410,
    date: "2025-06-25",
    note: "Weekly stock-up",
  },
  {
    id: "tx-4",
    type: "income",
    category: "Freelance",
    amount: 2200,
    date: "2025-06-24",
    note: "Retainer work",
  },
  {
    id: "tx-5",
    type: "expense",
    category: "Utilities",
    amount: 260,
    date: "2025-06-23",
  },
];

export default function Home() {
  return (
    <PageShell>
      <div className="space-y-6">
        <div className="flex flex-col gap-2">
          <h1 className="text-3xl font-bold text-foreground">Dashboard</h1>
          <p className="text-sm text-slate-600">
            Overview of your latest income, expenses, and progress toward goals.
          </p>
        </div>

        <div className="grid-auto-fill">
          <StatCard
            label="Total income"
            value={summary.income}
            delta={{ value: 8.2, positive: true }}
            icon={<ArrowUpRight className="h-5 w-5" />}
          />
          <StatCard
            label="Total expenses"
            value={summary.expenses}
            delta={{ value: 5.4, positive: false }}
            variant="danger"
            icon={<ArrowDownRight className="h-5 w-5" />}
          />
          <StatCard
            label="Net position"
            value={summary.net}
            delta={{ value: 2.1, positive: true }}
            variant="success"
            icon={<Wallet2 className="h-5 w-5" />}
          />
        </div>

        <div className="grid gap-6 lg:grid-cols-3">
          <CardSection
            className="lg:col-span-2"
            title="Cashflow"
            description="Income vs expenses over the past 6 months"
            action={
              <div className="rounded-full bg-accent-muted px-3 py-1 text-xs font-semibold text-accent">
                Net {formatCurrency(summary.net)}
              </div>
            }
          >
            <IncomeExpenseChart data={chartData} />
          </CardSection>
          <GoalProgress goals={goals} />
        </div>

        <div className="grid gap-6 lg:grid-cols-3">
          <TransactionsTable transactions={recentTransactions} className="lg:col-span-2" />
          <CardSection
            title="Goal contributions"
            description="Recent contributions across goals"
            className="lg:col-span-1"
          >
            <div className="space-y-3">
              {goals.map((goal) => (
                <div key={goal.id} className="rounded-xl border border-border/70 bg-white p-4">
                  <div className="flex items-center justify-between text-sm font-semibold text-foreground">
                    <span>{goal.name}</span>
                    <PiggyBank className="h-5 w-5 text-accent" />
                  </div>
                  <p className="mt-1 text-xs text-slate-500">
                    {formatCurrency(goal.currentAmount)} saved of {formatCurrency(goal.targetAmount)}
                  </p>
                </div>
              ))}
            </div>
          </CardSection>
        </div>
      </div>
    </PageShell>
  );
}
